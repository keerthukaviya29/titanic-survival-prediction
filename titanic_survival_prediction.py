# -*- coding: utf-8 -*-
"""titanic_survival_prediction

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1SrJrxIxznDbN4EP1U9VEzZ8wGzSAk15A
"""

from google.colab import drive
drive.mount('/content/drive')

!ls "/content/drive/My Drive/titanic"

import pandas as pd

df = pd.read_csv("/content/drive/MyDrive/titanic/train.csv")
df.head()

df.shape

df.columns

df.isnull().sum()

# Drop Cabin (too many missing values)
df.drop(columns=['Cabin'], inplace=True)

# Fill Age (median is best for skewed data)
df['Age'] = df['Age'].fillna(df['Age'].median())

# Fill Embarked (mode)
df['Embarked'] = df['Embarked'].fillna(df['Embarked'].mode()[0])

# Encode Sex manually
df['Sex'] = df['Sex'].map({'male': 0, 'female': 1})

# One-hot encode Embarked
df = pd.get_dummies(df, columns=['Embarked'], drop_first=True)

df.head()

# Select required features
features = ['Age', 'Fare', 'Pclass', 'Sex', 'SibSp', 'Parch']
X = df[features]

# Target
y = df['Survived']

X.head()

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

X_train.shape, X_test.shape

from sklearn.linear_model import LogisticRegression

model = LogisticRegression(max_iter=1000)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, confusion_matrix

print("Accuracy:", accuracy_score(y_test, y_pred))
print("Precision:", precision_score(y_test, y_pred))
print("Recall:", recall_score(y_test, y_pred))
print("F1 Score:", f1_score(y_test, y_pred))
print("\nConfusion Matrix:\n", confusion_matrix(y_test, y_pred))

import seaborn as sns
import matplotlib.pyplot as plt

sns.barplot(data=df, x='Sex', y='Survived')
plt.title("Survival Rate by Gender")
plt.show()

sns.barplot(data=df, x='Pclass', y='Survived')
plt.title("Survival Rate by Passenger Class")
plt.show()

df['AgeGroup'] = pd.cut(df['Age'], bins=[0, 12, 18, 40, 60, 80],
                        labels=['Child', 'Teen', 'Adult', 'Middle Age', 'Senior'])

sns.barplot(data=df, x='AgeGroup', y='Survived')
plt.title("Survival Rate by Age Group")
plt.xticks(rotation=45)
plt.show()